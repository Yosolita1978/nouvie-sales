## 2026-01-30

**Done**
- Implemented full PromoMix 2026 feature for nouvie-sales (admin system)
- Created `lib/promomix-config.ts` with 13 eligible products (5 hogar, 8 capilar), matching exact DB product names
- Created `lib/promomix-utils.ts` with calculation and validation functions
- Added `orderType` field to Prisma schema (`"normal"` | `"promomix"`) and pushed to Supabase
- Updated `POST /api/orders` to validate PromoMix eligibility, enforce $300K minimum, and override prices with promo prices (server as source of truth)
- Updated order creation UI: order type toggle, product filtering (only 13 eligible when PromoMix), promo pricing display with strikethrough original, budget tracker with progress bar
- Added PromoMix badge (amber) to order list view
- Updated order detail view with PromoMix badge, original vs promo prices, and savings summary
- Updated PDF generation with "PROMOMIX 2026" header badge, original prices per item, savings total, and "Envio no incluido" note
- Added `DIRECT_URL` to `.env` (required by Prisma for `directUrl` in schema)
- Updated `Order` interface in `types/index.ts` with `orderType` field

**Decisions** (see DECISIONS.md)
- Product name matching via `findPromoMixByName()` (case-insensitive exact match against DB names)
- Hogar discount is 20% (not 2% as originally in spec — confirmed via nouvie-web screenshot)
- Used `prisma db push` instead of `prisma migrate dev` (existing DB had no migration history)

**Blocked/Waiting**
- Need to verify on Vercel that `DIRECT_URL` env var is set (may cause build issues if missing)
- Product names in config must stay in sync with database — if a product name changes in DB, config needs updating

**Learned**
- DB product names differ from nouvie-web marketing names (e.g., "Suave y Liso" not "Honey Melon", "Detergente Lavavajillas" not "Detergente Neutro")
- DB capilar product sizes are 237ml (shampoos) and 177ml (mascarillas/lociones), not 250ml as in the spec
- `@react-pdf/renderer` doesn't support `text-decoration: line-through`, used "(Antes: $X)" text instead
- The `.env` file had no trailing newline, causing appended vars to concatenate with the last line

**Next**
- Test full PromoMix flow end-to-end (create order, view, download PDF)
- Verify product name matching works for all 13 products
- Confirm PDF renders correctly with PromoMix layout
- Add `DIRECT_URL` to Vercel environment variables
- Deploy to production
